import{j as e,_ as X,I as j,az as ge,ag as fe,aA as ve,K as F,Q as S,aB as je,H as be,y as Ce,Y as we,r as Ne}from"./v_7_4_0_8_72a965e9-2917-4293-acb8-268c1a8cad5010.js";import{a as r}from"./v_7_4_0_8_72a965e9-2917-4293-acb8-268c1a8cad504.js";import{S as _e,C as ye}from"./v_7_4_0_8_72a965e9-2917-4293-acb8-268c1a8cad508.js";import{A as W,L as G}from"./v_7_4_0_8_72a965e9-2917-4293-acb8-268c1a8cad505.js";import{m as ke,u as Le,a as Ee,a5 as Se,n as Re}from"./v_7_4_0_8_72a965e9-2917-4293-acb8-268c1a8cad5022.js";import{a as Ae,u as K}from"./v_7_4_0_8_72a965e9-2917-4293-acb8-268c1a8cad5019.js";import{u as Me}from"./v_7_4_0_8_72a965e9-2917-4293-acb8-268c1a8cad5027.js";import{u as Ie,a as $e}from"./v_7_4_0_8_72a965e9-2917-4293-acb8-268c1a8cad5021.js";import"./v_7_4_0_8_72a965e9-2917-4293-acb8-268c1a8cad5046.js";import{E as Pe}from"./v_7_4_0_8_72a965e9-2917-4293-acb8-268c1a8cad50118.js";import{V as Fe}from"./v_7_4_0_8_72a965e9-2917-4293-acb8-268c1a8cad50142.js";import{a as ze}from"./v_7_4_0_8_72a965e9-2917-4293-acb8-268c1a8cad5077.js";import{V as Be,W as d}from"./v_7_4_0_8_72a965e9-2917-4293-acb8-268c1a8cad5018.js";import{d as Te}from"./v_7_4_0_8_72a965e9-2917-4293-acb8-268c1a8cad50129.js";import"./v_7_4_0_8_72a965e9-2917-4293-acb8-268c1a8cad507.js";import"./v_7_4_0_8_72a965e9-2917-4293-acb8-268c1a8cad50.js";import"./v_7_4_0_8_72a965e9-2917-4293-acb8-268c1a8cad506.js";import"./v_7_4_0_8_72a965e9-2917-4293-acb8-268c1a8cad502.js";import"./v_7_4_0_8_72a965e9-2917-4293-acb8-268c1a8cad503.js";import"./v_7_4_0_8_72a965e9-2917-4293-acb8-268c1a8cad509.js";const Ue=r.lazy(() => __vitePreload(()=>import(chrome.runtime.getURL("content/assets/js/v_7_4_0_8_72a965e9-2917-4293-acb8-268c1a8cad50143.js")),[]));function De({setListagem:u,perfilBase:x}){return e.jsx(r.Suspense,{fallback:e.jsx(e.Fragment,{}),children:e.jsx(Ue,{setListagem:u,perfilBase:x})})}const He=r.lazy(() => __vitePreload(()=>import(chrome.runtime.getURL("content/assets/js/v_7_4_0_8_72a965e9-2917-4293-acb8-268c1a8cad50144.js")),[]));function Oe({list:u}){return e.jsx(r.Suspense,{fallback:e.jsx(e.Fragment,{}),children:e.jsx(He,{list:u})})}async function Ve(u){const{user:x}=ke.getState(),{label:_}=Ae.getState(),y=K.getState().language;if(u.length===0)return j({type:"Error",message:y.nenhumCtsSelecionado,position:"top-right"});const h=x.estado?u:u.slice(0,5);x.estado||j({type:"Info",message:y.limite_de_5,position:"top-right"});const c={contacts:h,labelName:_.name};try{const g=await fetch(`${Be.backend_utils}api/XLSX/envioEmMassa`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!g.ok)throw new Error("Erro ao enviar dados para o servidor");const R=await g.json();Te(R.XLSXbase64,`${_.name}_EnvioEmMassa.xlsx`)}catch(g){console.error("Erro ao enviar dados para o servidor:",g),j({type:"Error",message:y.erroEnvio,position:"top-right"})}}function qe({}){const u=Le(t=>t.crm),{userTabs:x}=Ee(),{perfil:_}=Se(),{setActiveMenu:y,activeMenu:h,viewContatos:c,setViewContatos:g}=Ie(),{open:R}=Re(),{setAgrupamentos:z,agrupamentos:B}=Me(),{chats:Y,setChats:T,setActiveAgrupamento:J}=$e(),{language:a}=K(),U=r.useRef(null),[m,f]=r.useState(0),[k,D]=r.useState("abas"),[L,p]=r.useState([]),[v,Q]=r.useState([]),[o,b]=r.useState(()=>h==="Envio Rápido"?Y:c.type==="edit"?c.content.chats:[]);r.useEffect(()=>{h==="Envio Rápido"&&T(o)},[o]);const[E,H]=r.useState(""),[$,Z]=r.useState(),[ee,te]=r.useState(!1);r.useEffect(()=>{(async()=>{te(await d.Profile("isBusiness"))})()});const[A,O]=r.useState(!1),[M,se]=r.useState(c.type==="edit"?c.content.name:""),[I,ae]=r.useState(c.type==="edit"?c.content.color:ge()),P=r.useRef(null),V=r.useRef(null);r.useEffect(()=>{const t=s=>{P.current&&!P.current.contains(s.target)&&!V.current.contains(s.target)&&O(!1)};return A&&document.addEventListener("click",t),()=>{document.removeEventListener("click",t)}},[A]),r.useEffect(()=>{(async()=>{let s;switch(m){case 0:const i=await d.Contact("List","onlyMyContacts");p(i.sort((n,l)=>n.name.localeCompare(l.name)));break;case 1:p(await d.Chat("List"));break;case 2:s=await d.Labels("getAllLabels"),w(s[0].id);break;case 3:p(await d.Chat("List","onlyGroups"));break;case 4:s=await d.Chat("List","onlyGroups"),w(s[0].id);break;case 6:if(k==="abas")s=x.map(n=>({id:n.tag,name:n.tag})),w(x[0].tag);else{const n=u.find(l=>l.id===k).list;s=n.map(l=>({id:l.id,name:l.name})),w(n[0].id)}break;case 7:s=[{id:"all",name:`${a.todos}`},{id:"aniversariantes-mes",name:`${a.aniversariantes}`},{id:"Masculino",name:`${a.sexo_masculino}`},{id:"Feminino",name:`${a.sexo_feminino}`}],w("all");break}Z(s)})()},[m,x,k]),r.useEffect(()=>{var s;const t=[];for(let i of L)(i.id.toUpperCase().includes(E.toUpperCase())||(s=i.name)!=null&&s.toUpperCase().includes(E.toUpperCase()))&&t.push(i);Q(t)},[E,L]);const w=async t=>{switch(m){case 2:p(await d.Contact("List",{type:"withLabels",id:t}));break;case 4:p(await d.Chat("List",{type:"getContatosGrupos",id:t,activeLid:!0}));break;case 6:if(k==="abas"){const i=x.filter(n=>n.tag===t);p(i.length!==0?await d.Utils("get-crmContatos",i[0].chats):[])}else{const n=u.find(l=>l.id===k).list.filter(l=>l.id===t);p(n.length!==0?await d.Utils("get-crmContatos",n[0].chats):[])}break;case 7:const s=_.map(i=>({id:i.userID,...i}));switch(t){case"all":p(await d.Utils("get-crmContatos",s));break;case"aniversariantes-mes":const i=new Date().getMonth(),n=s.filter(C=>C.dataNascimento.length!==0&&i===new Date(C.dataNascimento).getMonth());p(await d.Utils("get-crmContatos",n));break;default:const l=s.filter(C=>C.sexo.length!==0&&C.sexo===t);p(await d.Utils("get-crmContatos",l));break}break}},ne=t=>{const s=o.findIndex(i=>i.id===t.id);if(s===-1)b([...o,t]);else{const i=[...o];i.splice(s,1),b(i)}},ie=()=>{const t=o.map(i=>i.id),s=v.filter(i=>!t.includes(i.id));b([...o,...s])},oe=()=>{const t=o.map(n=>n.id),s=v.filter(n=>t.includes(n.id)),i=o.filter(n=>!s.some(l=>l.id===n.id));b(i)},re=()=>v.map(s=>s.id).every(s=>o.some(i=>i.id===s)),N=t=>{if(t>0){const s=o.slice();for(let i=0;i<t;i++){const n=v.find(l=>!s.some(C=>C.id===l.id));n&&s.push(n)}b(s)}else if(t<0){const s=Math.abs(t),i=o.slice(0,-s);b(i)}},q=()=>o.length===0?(j({type:"Error",message:`${a.selecione_um_cts}`,position:"top-right"}),!1):M.length<3?(j({type:"Error",message:`${a.insira_nome}`,position:"top-right"}),!1):!0,le=()=>{q()&&(z([...B,{id:Ne(),name:M,color:I,chats:o}]),g({isOpen:!0,type:"create",content:[]}),j({type:"Success",message:`${a.agrupamento_criado}`,position:"top-right"}))},ce=()=>{q()&&(z(B.map(t=>t.id===c.content.id?{id:c.content.id,name:M,color:I,chats:o}:t)),g({isOpen:!0,type:"create",content:[]}),j({type:"Success",message:`${a.agrupamento_editado}`,position:"top-right"}))},de=()=>{if(o.length===0){j({type:"Error",message:`${a.selecione_um_cts}`,position:"top-right"});return}T(o),J({name:`${a.nao_agrupado}`,color:"var(--primaria)"}),y("Enviar Campanha")},me=e.jsxs("div",{className:"flex flex-col gap-4 justify-start w-[200px]",children:[a.cts_segmento,e.jsx("button",{className:"btn-confirmation btn-agrupamento "+(m===0?"btn-activeList":""),onClick:()=>f(0),children:a.cts_salvos}),e.jsx("button",{className:"btn-confirmation btn-agrupamento "+(m===1?"btn-activeList":""),onClick:()=>f(1),children:"Inbox"}),ee&&e.jsx("button",{className:"btn-confirmation btn-agrupamento "+(m===2?"btn-activeList":""),onClick:()=>f(2),children:a.etiquetas}),e.jsx("button",{className:"btn-confirmation btn-agrupamento "+(m===3?"btn-activeList":""),onClick:()=>f(3),children:a.grupos}),e.jsx("button",{className:"btn-confirmation btn-agrupamento "+(m===4?"btn-activeList":""),onClick:()=>f(4),children:a.cts_grupos}),e.jsxs("div",{className:"dropdown dropdown-right dropdown-end",onClick:()=>f(6),children:[e.jsx("div",{tabIndex:0,role:"button",className:"btn-confirmation btn-agrupamento !w-full !flex justify-center items-center "+(m===6?"btn-activeList":""),children:"CRM"}),e.jsx("ul",{tabIndex:0,ref:U,className:"dropdown-content z-[1] menu p-2 shadow-lg bg-base-100 rounded-box w-52 _2sDI2 _1b6oD max-h-[1000%]",onClick:()=>U.current.blur(),children:e.jsxs("div",{className:"overflow-y-auto",children:[e.jsx("li",{children:e.jsxs("div",{className:"flex bugiwsl0 fooq7fky",onClick:()=>D("abas"),children:[e.jsx("span",{children:e.jsx(fe,{className:"h-5 w-5 text-[var(--primaria)]"})}),e.jsx("span",{children:a.abas})]})}),u.map(t=>e.jsx("li",{children:e.jsxs("div",{className:"flex bugiwsl0 fooq7fky",onClick:()=>D(t.id),children:[e.jsx("span",{style:{color:t.hexColor},children:e.jsx(_e,{className:"h-5 w-5"})}),e.jsx("span",{children:t.name})]})}))]})})]}),e.jsx("button",{className:"btn-confirmation btn-agrupamento "+(m===7?"btn-activeList":""),onClick:()=>f(7),children:a.perfil_cts}),e.jsx("button",{className:"btn-confirmation btn-agrupamento w-full "+(m===5&&"btn-activeList"),onClick:()=>{f(5),R(e.jsx(Oe,{list:t=>p(t)}))},children:a.importar_planilha}),e.jsx("span",{className:"flex items-center m-auto",children:e.jsx("button",{className:"btn-confirmation btn-8 m-auto",style:o.length===0?{backgroundImage:"none"}:{},onClick:()=>Ve(o),children:e.jsxs("span",{className:"gap-2",children:[e.jsxs("div",{children:[" ",e.jsx(ve,{size:20})," "]}),e.jsxs("div",{className:"pt-1",children:[" ",a.exportaEmCSV," "]})]})})})]}),pe=({index:t,key:s,style:i})=>{const n=v[t];return e.jsx("li",{style:i,children:e.jsx("div",{className:"form-control",children:e.jsxs("label",{className:"cursor-pointer label gap-2 justify-start",children:[e.jsx(we,{id:s,estado:o.some(l=>l.id===n.id),checkedUpdade:()=>ne(n)}),e.jsx("span",{className:"font-bold text-base overflow-hidden text-ellipsis whitespace-nowrap max-w-[300px]",children:n.name}),e.jsx("span",{children:n.id.includes("@")?n.id.split("@")[0]:n.id})]})})},s)},ue=e.jsxs("div",{className:"flex-auto grid",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex gap-2 items-center pb-2",children:[e.jsx("span",{className:"w-full",children:e.jsx("input",{type:"text",value:E,onChange:t=>H(t.target.value),placeholder:a.pesquisar_numero,className:"input input-bordered w-full input-sm"})}),E.length!==0&&e.jsx("span",{className:"flex items-center",children:e.jsx(F,{name:a.limpar,funcao:()=>H("")})}),v.length!==0&&e.jsx("span",{className:"flex items-center",style:{whiteSpace:"nowrap"},children:re()?e.jsx(F,{name:a.remover_todos,funcao:oe}):e.jsx(S,{name:`${a.selecionar_todos} (${L==null?void 0:L.length})`,funcao:ie})})]}),$&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("select",{className:"select select-bordered w-full select-sm pt-0",onChange:t=>w(t.target.value),children:$.map((t,s)=>e.jsx("option",{value:t.id,children:t.name},s))}),m===7&&e.jsxs("div",{className:"btn-confirmation btn-agrupamento !flex justify-center items-center !px-2 gap-1",onClick:()=>R(e.jsx(De,{setListagem:p,perfilBase:_})),children:[e.jsx("span",{"data-icon":"filter",children:e.jsx("svg",{className:"fill-[var(--letra)]",viewBox:"0 0 24 24",height:"20",width:"20",preserveAspectRatio:"xMidYMid meet",version:"1.1",x:"0px",y:"0px",enableBackground:"new 0 0 24 24",children:e.jsx("path",{d:"M10,18.1h4v-2h-4V18.1z M3,6.1v2h18v-2H3z M6,13.1h12v-2H6V13.1z"})})}),e.jsx("h3",{className:"text-[var(--letra)] whitespace-nowrap",children:a.filtro_avancado})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx("div",{className:"badge bg-[var(--primaria)] pulse text-[var(--letra)] cursor-pointer font-bold",onClick:()=>N(200),children:"+200"}),e.jsx("div",{className:"badge badge-error pulse text-[var(--letra)] cursor-pointer font-bold",onClick:()=>N(-200),children:"-200"}),e.jsx("div",{className:"badge bg-[var(--primaria)] pulse text-[var(--letra)] cursor-pointer font-bold",onClick:()=>N(100),children:"+100"}),e.jsx("div",{className:"badge badge-error pulse text-[var(--letra)] cursor-pointer font-bold",onClick:()=>N(-100),children:"-100"}),e.jsx("div",{className:"badge bg-[var(--primaria)] pulse text-[var(--letra)] cursor-pointer font-bold",onClick:()=>N(10),children:"+10"}),e.jsx("div",{className:"badge badge-error pulse text-[var(--letra)] cursor-pointer font-bold",onClick:()=>N(-10),children:"-10"})]})]}),e.jsx("div",{className:"overflow-auto",children:e.jsx("ul",{className:"w-full overflow-auto overflow-x-hidden",style:$?{height:"calc(100vh - 250px)",maxHeight:"calc(100vh - 250px)"}:{height:"calc(100vh - 225px)",maxHeight:"calc(100vh - 225px)"},children:v.length!==0?e.jsx(W,{children:({width:t,height:s})=>e.jsx(G,{width:t,height:s,rowCount:v.length,rowHeight:35,rowRenderer:pe})}):e.jsx("div",{className:"p-4 border-dotted border rounded-lg text-center mt-2",children:a.nenhum_cts_encontrado})})})]}),he=({index:t,key:s,style:i})=>{const n=o[t];return e.jsx("li",{style:i,className:"!w-fit",children:e.jsxs("div",{className:"flex gap-1 items-center",children:[e.jsx(Fe,{id:n.id}),e.jsx("span",{className:"font-bold text-base overflow-hidden text-ellipsis whitespace-nowrap max-w-[200px]",children:n.name}),e.jsx("span",{children:n.id.includes("@")?n.id.split("@")[0]:n.id})]})},n.id)},xe=e.jsxs("div",{className:"flex items-center flex-auto flex-col gap-4",children:[e.jsxs("div",{className:"indicator",children:[o.length!==0&&e.jsxs("span",{className:"indicator-item badge bg-[var(--primaria)] text-[var(--letra)] font-medium",children:["+",o.length]}),e.jsx("span",{className:"p-2 text-xl",children:a.cts_selecionados_envio})]}),o.length!==0&&e.jsx("div",{className:"absolute right-8 mt-6 top-[83px]",children:e.jsx(F,{name:a.remover_selecao,funcao:()=>b([])})}),e.jsx("div",{className:"w-full pt-2",style:{height:`calc(100vh - ${h==="Envio Rápido"?"200px":"400px"} )`},children:e.jsx("ul",{className:"gap-2 justify-center ",style:{maxHeight:`calc(100vh - ${h==="Envio Rápido"?"200px":"400px"})`,height:`calc(100vh - ${h==="Envio Rápido"?"200px":"400px"})`},children:o.length!==0?e.jsx(W,{children:({width:t,height:s})=>e.jsx(G,{width:t,height:s,rowCount:o.length,rowHeight:25,rowRenderer:he})}):e.jsx("div",{className:"p-4 rounded-lg text-center mt-2 overflow-hidden justify-center flex items-center",children:e.jsxs("div",{className:"alert alert-warning",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current shrink-0 h-6 w-6 text-[var(--letra)]",fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("span",{className:"text-[var(--letra)] font-medium",children:a.nenhum_cts_selecionado})]})})})}),h!=="Envio Rápido"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-full grid gap-3",children:[A&&e.jsx("div",{className:"absolute",children:e.jsx("div",{className:"relative bottom-52",ref:P,children:e.jsx(ye,{disableAlpha:!0,color:I,onChange:t=>ae(t.hex),className:"p-2 rounded"})})}),e.jsx(Pe,{id:"Agrupamento_TextArea",titulo:a.nome_agrupamento,type:"input",position:"top-end",placeholder:a.insira_nome_agrupamento,text:M,setText:t=>se(t),heightTextArea:490}),e.jsxs("div",{className:"flex  gap-2 items-center pt-3",children:[e.jsx("h2",{children:a.selecione_cor}),e.jsx("span",{className:"pulse cursor-pointer border border-black rounded border-solid lg:tooltip lg:tooltip-right",ref:V,onClick:()=>O(!A),"data-tip":a.selecionar_cor_agrupamento,children:e.jsx(je,{className:"h-8 w-8",style:{color:I}})})]})]}),e.jsx("div",{className:"pt-4 gap-4 pb-2 flex",children:c.type==="edit"?e.jsx(S,{name:a.editar,funcao:ce}):e.jsxs(e.Fragment,{children:[e.jsx(S,{name:a.criar_agrupamento,funcao:le}),e.jsx(S,{name:a.enviar_sem_agrupar,funcao:de})]})})]})]});return e.jsxs("div",{"data-id":a.envio_container,style:{height:"calc(100vh - 42px)"},children:[h!=="Envio Rápido"&&e.jsx(be,{children:a.desc_agrupamentos}),e.jsxs("div",{className:"flex gap-2 items-center p-2 pt-2",children:[e.jsx(Ce,{children:h==="Envio Rápido"?`${a.selecione_cts}`:c.type==="edit"?`${a.editar_agrupamento}`:`${a.criar_agrupamento}`}),h!=="Envio Rápido"&&(c.type==="edit"?e.jsx("span",{className:"pulse cursor-pointer lg:tooltip lg:tooltip-right","data-tip":a.voltar,onClick:()=>g({isOpen:!0,type:"create",content:[]}),children:e.jsx(ze,{className:"w-6 h-6 text-[var(--primaria)]",strokeWidth:1})}):e.jsx("div",{className:"pulse cursor-pointer lg:tooltip lg:tooltip-right","data-tip":a.grupos_salvos_desc,children:e.jsx(S,{name:a.agrupamentos_salvos_contatos,funcao:()=>g({isOpen:!0,type:"create",content:[]})})}))]}),e.jsxs("div",{className:"flex pt-4 gap-5",style:{height:"calc(100vh - 121px)"},children:[me,ue,xe]})]})}const ut=r.memo(qe);export{ut as default};
